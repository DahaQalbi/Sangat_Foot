<div class="p-6 min-h-[70vh] bg-white bg-[url('/assets/images/food-pattern-outline-dense.svg')] bg-repeat bg-[length:150px_150px]">
  <div class="mx-auto w-full max-w-[600px] rounded-xl bg-white/80 p-6 backdrop-blur-sm shadow">
    <h1 class="mb-6 text-2xl font-extrabold uppercase text-primary">Add Staff</h1>

    <form class="space-y-5 dark:text-white" [formGroup]="form" (ngSubmit)="onSubmit()">
      <!-- Name -->
      <div>
        <label for="Name">Name</label>
        <div class="relative text-white-dark">
          <input id="Name" formControlName="name" type="text" placeholder="Enter Name" class="form-input ps-10 placeholder:text-white-dark" />
          <span class="absolute start-4 top-1/2 -translate-y-1/2">
            <icon-user class="h-5 w-5" />
          </span>
        </div>
      </div>

      <!-- Email Address -->
      <div>
        <label for="Email">Email Address</label>
        <div class="relative text-white-dark">
          <input id="Email" formControlName="email" type="email" placeholder="Enter Email Address" class="form-input ps-10 placeholder:text-white-dark" />
          <span class="absolute start-4 top-1/2 -translate-y-1/2">
            <icon-mail [fill]="true" />
          </span>
        </div>
      </div>

      <!-- Phone Number -->
      <div>
        <label for="Phone">Phone Number</label>
        <div class="relative text-white-dark">
          <input id="Phone" formControlName="phone" type="text" placeholder="1234567890" class="form-input ps-10 placeholder:text-white-dark" />
          <span class="absolute start-4 top-1/2 -translate-y-1/2">
            <icon-phone class="h-5 w-5" />
          </span>
        </div>
      </div>

      <!-- Password -->
      <div>
        <label for="Password">Password</label>
        <div class="relative text-white-dark">
          <input id="Password" formControlName="password" type="password" placeholder="Enter Password" class="form-input ps-10 placeholder:text-white-dark" />
          <span class="absolute start-4 top-1/2 -translate-y-1/2">
            <icon-lock-dots [fill]="true" />
          </span>
        </div>
      </div>

      <!-- Uploads: Agreement, CNIC (image), Profile Image -->
      <div>
        <h3 class="mb-2 text-lg font-semibold text-gray-800 dark:text-white">Uploads</h3>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <!-- Agreement Upload -->
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Agreement Upload</label>
            <div class="relative w-full h-28 border border-gray-200 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors overflow-hidden cursor-pointer" (click)="agreementInput.click()">
              <!-- Remove button -->
              <button *ngIf="agreementPreview" type="button" (click)="removeAgreement(); $event.stopPropagation()" class="absolute top-1 right-1 z-10 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
              </button>
              <!-- Preview content -->
              <ng-container *ngIf="agreementPreview; else agreementPlaceholder">
                <ng-container *ngIf="isPdf(agreementFileType); else agreementImage">
                  <div class="w-full h-full grid place-items-center bg-gray-100 text-gray-600">
                    <span class="text-xs font-semibold">PDF Selected</span>
                  </div>
                </ng-container>
                <ng-template #agreementImage>
                  <img [src]="agreementPreview" class="w-full h-full object-cover" alt="Agreement" />
                </ng-template>
              </ng-container>
              <!-- Placeholder -->
              <ng-template #agreementPlaceholder>
                <div class="flex flex-col items-center justify-center w-full h-full">
                  <svg class="w-12 h-12 text-gray-300" fill="currentColor" viewBox="0 0 24 24"><path d="M4 5a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V7a2 2 0 00-2-2H4zm3 4a2 2 0 110-4 2 2 0 010 4zm13 8H4l4-6 3 4 2-3 7 5z"/></svg>
                </div>
                
              </ng-template>
              <!-- upload badge (always visible) -->
              <span class="absolute -top-3 -right-3 inline-flex items-center justify-center w-9 h-9 rounded-full bg-gray-300 shadow border border-gray-200">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M8 12l4-4m0 0l4 4m-4-4v12" />
                </svg>
              </span>
            </div>
            <input #agreementInput type="file" accept=".pdf,image/*" (change)="onAgreementSelect($event)" class="hidden" />
          </div>
          <!-- ID Card (CNIC) -->
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">ID Card</label>
            <div class="relative w-full h-28 border border-gray-200 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors overflow-hidden cursor-pointer" (click)="cnicInput.click()">
              <button *ngIf="cnicPreview" type="button" (click)="removeCnic(); $event.stopPropagation()" class="absolute top-1 right-1 z-10 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
              </button>
              <ng-container *ngIf="cnicPreview; else cnicPlaceholder">
                <img [src]="cnicPreview" class="w-full h-full object-cover" alt="CNIC" />
              </ng-container>
              <ng-template #cnicPlaceholder>
                <div class="flex flex-col items-center justify-center w-full h-full">
                  <svg class="w-12 h-12 text-gray-300" fill="currentColor" viewBox="0 0 24 24"><path d="M3 5a2 2 0 012-2h14a2 2 0 012 2v3H3V5zm0 5h18v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6zm4 3h6v2H7v-2z"/></svg>
                </div>
              
              </ng-template>
              <!-- upload badge (always visible) -->
              <span class="absolute -top-3 -right-3 inline-flex items-center justify-center w-9 h-9 rounded-full bg-gray-300 shadow border border-gray-200">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M8 12l4-4m0 0l4 4m-4-4v12" />
                </svg>
              </span>
            </div>
            <input #cnicInput type="file" accept="image/*" (change)="onCnicSelect($event)" class="hidden" />
          </div>
          <!-- Image -->
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Image</label>
            <div class="relative w-full h-28 border border-gray-200 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors overflow-hidden cursor-pointer" (click)="imageInput.click()">
              <button *ngIf="imagePreview" type="button" (click)="removeImage(); $event.stopPropagation()" class="absolute top-1 right-1 z-10 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
              </button>
              <ng-container *ngIf="imagePreview; else imagePlaceholder">
                <img [src]="imagePreview" class="w-full h-full object-cover" alt="Image" />
              </ng-container>
              <ng-template #imagePlaceholder>
                <div class="flex flex-col items-center justify-center w-full h-full">
                  <svg class="w-12 h-12 text-gray-300" fill="currentColor" viewBox="0 0 24 24"><path d="M4 7a2 2 0 012-2h2l1-1h6l1 1h2a2 2 0 012 2v10a2 2 0 01-2 2H6a2 2 0 01-2-2V7zm8 2a4 4 0 100 8 4 4 0 000-8z"/></svg>
                </div>
                
              </ng-template>
              <!-- upload badge (always visible) -->
              <span class="absolute -top-3 -right-3 inline-flex items-center justify-center w-9 h-9 rounded-full bg-gray-300 shadow border border-gray-200">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M8 12l4-4m0 0l4 4m-4-4v12" />
                </svg>
              </span>
            </div>
            <input #imageInput type="file" accept="image/*" (change)="onImageSelect($event)" class="hidden" />
          </div>
        </div>
      </div>

      <!-- Role -->
      <div>
        <label for="Role">Role</label>
        <div class="relative text-white-dark">
          <select id="Role" formControlName="role" class="form-select ps-4 placeholder:text-white-dark">
            <option *ngFor="let r of roles" [ngValue]="r">{{ r }}</option>
          </select>
        </div>
      </div>

      <!-- Manager (only for Waiter) -->
      <div *ngIf="form.get('role')?.value === Role.Waiter">
        <div class="flex items-center justify-between">
          <label for="Manager">Manager</label>
          <span *ngIf="loadingManagers" class="text-xs text-gray-500">Loading managers...</span>
        </div>
        <div class="relative text-white-dark">
          <select id="Manager" formControlName="managerId" class="form-select ps-4 placeholder:text-white-dark">
            <option [ngValue]="null">-- Select Manager (optional) --</option>
            <option *ngFor="let m of managers" [ngValue]="m.id">{{ m.name }} ({{ m.email }})</option>
          </select>
        </div>
        <div *ngIf="error" class="mt-1 text-xs text-red-600">{{ error }}</div>
      </div>

      <div class="flex items-center gap-3 pt-2">
        <button type="submit" class="px-4 py-2 rounded-md bg-violet-500 text-white hover:bg-violet-600 transition-colors">Save</button>
        <button type="button" class="px-4 py-2 rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors">Cancel</button>
      </div>
    </form>
  </div>
</div>
